var AnalyticType,Param,Game,CoreInstanceType,Platform,__awaiter=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}l((n=n.apply(t,e||[])).next())}))};class Core{constructor(t,e){if(null==Core.context&&(Core.context=new Context),null==e||0==e){let t=location;Core.dev=!!t&&("localhost"===location.hostname||"127.0.0.1"===location.hostname)}else Core.dev=e;null==Core.keychain&&(Core.keychain=new Keychain),null!=t&&Core.keychain.addMethod(Keychain.getMethod(t))}getLoginManager(){return new LoginHelper}getContext(){return Core.context}static getKeychain(){return Core.keychain}getInstance(t){return __awaiter(this,void 0,void 0,(function*(){return yield(new Call).addParam(Param.Instance,t).commit("instance/get/").then((t=>Instance.fromObject(t)))}))}getNetwork(t){return __awaiter(this,void 0,void 0,(function*(){return yield(new Call).addParam(Param.Network,t).commit("network/get/").then((t=>Network.fromObject(t)))}))}static getCopy(){return new Core}static getAuth(){let t=null,e=Core.keychain.getMethods();for(let r=0;r<e.length;r++){const n=e[r];if(null==t)t=n;else if(n instanceof CoreSession&&t instanceof Key){t=n;break}}return t}static addAuth(t){Core.keychain.addMethod(t);try{Core.context.updateSubscriptionStatus()}catch(t){}}getPlayer(){return null!=Core.keychain.getSession()?Core.keychain.getSession().getPlayer():null}}try{module.exports=Core}catch(t){}class Analytics{static fromObject(t,e){let r=new Analytics;r.list=new Array,r.base=t.base,r.beggining=Util.date(t.beggining),r.period=Number(t.period);for(let n=0;n<t.list.length;n++){const i=t.list[n];if(e!=AnalyticType.Revenue)throw new Error("Unknown type");r.list.push(RevenueAnalytic.fromObject(i))}return r.type=e,r}fill(t=null){if(null==t||t instanceof Date||(t=Util.date(t)),null==t&&(t=new Date),t instanceof Date){let e=this.list.reverse(),r=new Array;for(let n=this.beggining.getTime()/1e3;n<=t.getTime()/1e3;n+=this.period)e.length>0&&e[0].getCreation().getTime()/1e3==n?(r.push(e[0]),e.shift()):this.type==AnalyticType.Revenue&&r.push((new RevenueAnalytic).empty(Util.date(n)));return this.list=r,this}throw new Error("Unknown until date")}getTotal(t){let e=0;for(let r=0;r<this.list.length;r++){const n=this.list[r];e+=Number(n.asObject()[t])}return e}}class MultipleAnalytics{static fromObject(t,e){let r=new MultipleAnalytics;r.analytics=new Array;for(let n=0;n<t.analytics.length;n++){const i=t.analytics[n];r.analytics.push(Analytics.fromObject(i,e))}return r}fill(){let t=new Array;for(let e=0;e<this.analytics.length;e++)t.push(this.analytics[e].fill());return this.analytics=t,this}}!function(t){t[t.Revenue=0]="Revenue"}(AnalyticType||(AnalyticType={}));class RevenueAnalytic{static fromObject(t){let e=new RevenueAnalytic;return e.creation=Util.date(t.creation),e.distinctCustomers=Number(t.distinctCustomers),e.totalRequests=Number(t.totalRequests),e.totalPayments=Number(t.totalPayments),e.totalRequested=Number(t.totalRequested),e.totalPaid=Number(t.totalPaid),e.totalDiscounted=Number(t.totalDiscounted),e.totalPotentialDiscount=Number(t.totalPotentialDiscount),e.totalTaxes=Number(t.totalTaxes),e.totalDisputed=Number(t.totalDisputed),e.totalRefunded=Number(t.totalRefunded),e.totalNet=Number(t.totalNet),e.totalGross=Number(t.totalGross),e.currency=String(t.currency),e}empty(t){return this.creation=t,this.distinctCustomers=0,this.totalRequests=0,this.totalPayments=0,this.totalRequested=0,this.totalPaid=0,this.totalDiscounted=0,this.totalPotentialDiscount=0,this.totalTaxes=0,this.totalDisputed=0,this.totalRefunded=0,this.totalNet=0,this.totalGross=0,this.currency=null,this}asObject(){return JSON.parse(JSON.stringify(this))}getCreation(){return this.creation}getBase(){return this.currency}}class Keychain{constructor(){this.authMethods=new Array}addMethod(t){this.authMethods.push(t)}getSession(){for(let t=0;t<this.authMethods.length;t++){const e=this.authMethods[t];if(e instanceof CoreSession)return e}return null}getMethods(){return this.authMethods}removeSessions(){let t=new Array;for(let e=0;e<this.authMethods.length;e++){const r=this.authMethods[e];r instanceof CoreSession||t.push(r)}this.authMethods=t}static getMethod(t){return"string"==typeof t?new Key(t):"object"==typeof t?CoreSession.fromObject(t):void 0}}class LoginHelper{constructor(t=!0){if(this.autoLogin=t,this.loggedIn=!1,this.autoLogin)try{this.loadSession(),this.loggedIn=!0}catch(t){}Core.getAuth()instanceof CoreSession&&(this.loggedIn=!0)}isLoggedIn(){return this.loggedIn}loadSession(){let t=CoreSession.load();return Core.addAuth(t),t}logout(){null!=localStorage.getItem(btoa("purecore-"+window.location.hostname+"l"))&&localStorage.removeItem(btoa("purecore-"+window.location.hostname+"l")),null!=localStorage.getItem(btoa("purecore-"+window.location.hostname+"d"))&&localStorage.removeItem(btoa("purecore-"+window.location.hostname+"d")),null!=localStorage.getItem(btoa("purecore-"+window.location.hostname+"h"))&&localStorage.removeItem(btoa("purecore-"+window.location.hostname+"h")),Core.getKeychain().removeSessions(),this.loggedIn=!1}login(t){return new Promise(((e,r)=>{if(t=Util.platformVal(t),null!=window)try{null!=LoginHelper.activeWindow&&LoginHelper.activeWindow.close();let n=600,i=400;const o=window.top.outerHeight/2+window.top.screenY-n/2,a=window.top.outerWidth/2+window.top.screenX-i/2;let s=window.open(this.getURL(t),"Login",`toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=${i}, height=${n}, top=${o}, left=${a}`);LoginHelper.activeWindow=s;let l=!0,c=null;window.addEventListener("message",(t=>{if("https://api.purecore.io"===t.origin)switch(t.data.message){case"login":l&&(c=Keychain.getMethod(t.data.data),Core.addAuth(c),s.closed||(s.close(),LoginHelper.activeWindow=null),l=!1),this.autoLogin&&c instanceof CoreSession&&(c.save(),this.loggedIn=!0),e(c)}}),!1);let u=setInterval((()=>{null!=LoginHelper.activeWindow&&LoginHelper.activeWindow.closed&&(LoginHelper.activeWindow=null),s.closed&&null==c&&(l=!1,clearInterval(u),r(new Error("The popup was closed before any session was retrieved")))}),50)}catch(t){r(t)}else r(new Error("In order to create a login popup, you must be executing purecore from a Document Object Model"))}))}getURL(t){let e="";switch(t){case Platform.Stadia:e+="google";break;case Platform.Steam:e+="steam";break;case Platform.Xbox:e+="microsoft";break;case Platform.Discord:e+="discord";break;default:throw new Error("Unsupported login method")}return`https://api.purecore.io/login/${e}/`}}class Key{constructor(t,e,r,n,i,o){this.hash=t,this.id=e,this.type=r,this.restrict=n,this.allowedReferrers=i,this.allowedRegions=o}getCredentials(){return this.hash}getParam(){return Param.Hash}static fromObject(t){if("hash"in t){let e=new Key(String(t.hash));if("id"in t&&(e.id=String(t.id)),"restrict"in t&&(e.restrict=Boolean(t.restrict)),"allowedReferrers"in t&&(e.allowedReferrers=new Array,Array.isArray(t.allowedReferrers)))for(let r=0;r<t.allowedReferrers.length;r++){const n=t.allowedReferrers[r];e.allowedReferrers.push(RefererRestriction.fromObject(n))}if("allowedRegions"in t&&(e.allowedRegions=new Array,Array.isArray(t.allowedRegions)))for(let r=0;r<t.allowedRegions.length;r++){const n=t.allowedRegions[r];e.allowedRegions.push(RegionRestriction.fromObject(n))}return e}throw new MissingProp("hash")}}class RefererRestriction{constructor(t,e,r){this.index=t,this.domain=e,this.ip=r}static fromObject(t){let e=new RefererRestriction;return e.index=Number(t.index),e.domain=String(t.domain),e.ip=String(t.ip),e}}class RegionRestriction{constructor(t,e,r,n){this.index=t,this.country=e,this.state=r,this.city=n}static fromObject(t){let e=new RegionRestriction;return e.index=Number(t.index),e.country=String(t.country),e.state=String(t.state),e.city=String(t.city),e}}class CoreSession{constructor(t,e,r,n,i,o,a){this.owner=t,this.location=e,this.device=r,this.usage=n,this.id=i,this.hash=o,this.network=a}getCredentials(){return this.hash}getParam(){return Param.Hash}asObject(){return{owner:this.owner.asObject(),location:this.location.asObject(),device:this.device.asObject(),usage:this.usage.asObject(),id:this.id,hash:this.hash,network:null==this.network?null:this.network.asObject()}}save(){if(!localStorage)throw new Error("Local storage unavailable");{let t=Math.floor(128*Math.random()),e=btoa(Util.generateGibberish(256+t)+this.hash+Util.generateGibberish(256+t)),r=Util.shortLengthToLong(t),n=this.asObject();delete n.hash,localStorage.setItem(btoa("purecore-"+window.location.hostname+"h"),e),localStorage.setItem(btoa("purecore-"+window.location.hostname+"d"),btoa(JSON.stringify(n))),localStorage.setItem(btoa("purecore-"+window.location.hostname+"l"),r)}}static load(){let t=localStorage.getItem(btoa("purecore-"+window.location.hostname+"h")),e=localStorage.getItem(btoa("purecore-"+window.location.hostname+"d")),r=localStorage.getItem(btoa("purecore-"+window.location.hostname+"l"));if(null!=t){if(null!=r){if(null!=e){let n=Util.longLengthToShort(r),i=atob(t),o=i.substr(256+n,i.length-2*(256+n)),a=JSON.parse(atob(e));return a.hash=o,CoreSession.fromObject(Keychain.getMethod(a))}throw localStorage.removeItem(btoa("purecore-"+window.location.hostname+"h")),localStorage.removeItem(btoa("purecore-"+window.location.hostname+"l")),new Error("Missing non-sensitive data")}throw localStorage.removeItem(btoa("purecore-"+window.location.hostname+"h")),new Error("No hash length found")}throw null!=r&&localStorage.removeItem(btoa("purecore-"+window.location.hostname+"l")),null!=e&&localStorage.removeItem(btoa("purecore-"+window.location.hostname+"d")),new Error("No hash found")}static fromObject(t){let e=new CoreSession;return"owner"in t&&(e.owner=Player.fromObject(t.owner)),"location"in t&&(e.location=SessionLocation.fromObject(t.location)),"device"in t&&(e.device=SessionDevice.fromObject(t.device)),"usage"in t&&(e.usage=SessionUsage.fromObject(t.usage)),"id"in t&&(e.id=String(t.id)),"hash"in t&&(e.hash=String(t.hash)),"network"in t&&(null!=t.network?e.network=Network.fromObject(t.network):e.network=null),e}getPlayer(){return this.owner}}class SessionDevice{constructor(t,e,r,n){this.os=t,this.device=e,this.brand=r,this.model=n}asObject(){return JSON.parse(JSON.stringify(this))}static fromObject(t){let e=new SessionDevice;return e.os=String(t.os),e.device=String(t.device),e.brand=String(t.brand),e.model=String(t.model),e}}class SessionLocation{constructor(t,e,r){this.city=t,this.state=e,this.country=r}asObject(){return JSON.parse(JSON.stringify(this))}static fromObject(t){let e=new SessionLocation;return e.city=String(t.city),e.state=String(t.state),e.country=String(t.country),e}}class SessionUsage{constructor(t,e){this.creation=t,this.uses=e}asObject(){let t=JSON.parse(JSON.stringify(this));return t.creation=Util.epoch(this.creation),t}static fromObject(t){let e=new SessionUsage;return e.creation=Util.date(t.creation),e.uses=Number(t.uses),e}}class Address{constructor(t,e,r,n,i,o,a,s){this.name=t,this.email=e,this.country=r,this.state=n,this.city=i,this.postalCode=o,this.line1=a,this.line2=s}static fromObject(t){let e=new Address;return e.name=null==t.name?null:String(t.name),e.email=null==t.email?null:String(t.email),e.country=null==t.country?null:String(t.country),e.state=null==t.state?null:String(t.state),e.city=null==t.city?null:String(t.city),e.postalCode=null==t.postalcode?null:String(t.postalcode),e.line1=null==t.line1?null:String(t.line1),e.line2=null==t.name?null:String(t.line2),e}asObject(){let t={};return null!=this.name&&(t.name=this.name),null!=this.email&&(t.email=this.email),null!=this.country&&(t.country=this.country),null!=this.state&&(t.state=this.state),null!=this.city&&(t.city=this.city),null!=this.postalCode&&(t.postalcode=this.postalCode),null!=this.line1&&(t.line1=this.line1),null!=this.line2&&(t.line2=this.line2),t}asQuery(){return JSON.stringify(this.asObject())}}class Method{static fromObject(t){let e=new Method;return e.creation=Util.date(t.creation),e.type=null==t.type?null:String(t.type),e.brand=null==t.brand?null:String(t.brand),e.wallet=null==t.wallet?null:String(t.wallet),e.id=null==t.id?null:String(t.id),e.visibleId=null==t.type?null:String(t.visibleId),e.default=!0===t.default,e}getId(){return this.id}getVisibleId(){return this.visibleId}isDefault(){return this.default}}class SubscriptionStatus{static fromObject(t){let e=new SubscriptionStatus;return e.plus=Boolean(t.plus),e.plusReview=Boolean(t.plusReview),e.plusGateway=Number(t.plusGateway),e.hostingReview=Boolean(t.hostingReview),e.hostingGateway=Number(t.hostingGateway),e.usedTrial=Util.date(t.usedTrial),e}isSubbed(){return this.plus}didUseTrial(){return null!=this.usedTrial}}class Call{constructor(){this.baseURL="https://api.purecore.io/rest/3",this.paramList=new Array}addParam(t,e){return this.paramList.push(new CallParam(t,e)),this}commit(t){return __awaiter(this,void 0,void 0,(function*(){let e={};for(let t=0;t<this.paramList.length;t++){const r=this.paramList[t];e[r.param]=r.value}let r=Core.getAuth();null!=r&&(e[r.getParam()]=r.getCredentials());let n=Call.formatEndpoint(t);const i=this.baseURL+n+"?"+Object.keys(e).filter((t=>e.hasOwnProperty(t))).map((t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t]))).join("&");if(Core.dev){var o=e;for(const t in o)Object.prototype.hasOwnProperty.call(o,t)&&t==r.getParam()&&(o[t]="***");console.log(this.baseURL+n,o)}return new Promise(((t,e)=>fetch(i,{method:"POST"}).then((t=>t.json())).then((e=>{if("error"in e)throw new Error(e.error+". "+e.msg);t(e)})).catch((t=>e(t)))))}))}static formatEndpoint(t){return(t.startsWith("/")?"":"/")+t+(t.endsWith("/")?"":"/")}}class CallParam{constructor(t,e){this.param=t,this.value=e}}!function(t){t.Year="ye",t.Years="ye",t.Month="mo",t.Months="mos",t.Week="we",t.Weeks="wes",t.Day="da",t.Days="das",t.Hour="ho",t.Hours="ho",t.Epoch="ep",t.PaymentMethod="pm",t.Address="ad",t.Key="k",t.Hash="h",t.Session="ses",t.Code="c",t.PaymentHash="ph",t.Bank="b",t.Description="desc",t.Name="nm",t.Platform="plt",t.Cname="cnm",t.Game="gme",t.PlatformId="plid",t.PlatformName="plnm",t.Quantity="qty",t.Value="val",t.Ip="ip",t.DeviceFingerprint="dv",t.ForumCategory="fc",t.ForumEmote="fe",t.ForumObject="fo",t.ForumOpinion="fop",t.ForumPost="fp",t.ForumReaction="fr",t.ForumReply="frp",t.ForumSection="fs",t.Connection="cn",t.Connections="cs",t.Command="cmd",t.CommandExecution="cex",t.EnvSource="es",t.Host="ht",t.Image="hi",t.ImageEnv="hie",t.HostTemplate="htt",t.Instance="i",t.Instances="is",t.Network="n",t.Server="s",t.Servers="ss",t.ServerGroup="sg",t.KeyId="kid",t.Machine="m",t.Notification="not",t.Payment="p",t.Discount="d",t.Discounts="ds",t.StoreItem="si",t.StoreItems="sis",t.StoreParam="sp",t.StoreParamResponse="spr",t.StoreParamResponses="sprs",t.Perk="pk",t.Perks="pks",t.StoreCategory="sc",t.Punishment="pn",t.Appeal="a",t.Report="r",t.Offence="o",t.Offences="os",t.PunishmentAction="pa",t.VotingSite="vs",t.Ticket="t",t.TicketCategory="tc",t.TicketReply="tr",t.Player="pl",t.Profile="pp",t.NetworkPlayer="np"}(Param||(Param={}));class MissingProp extends Error{constructor(t){super(t),this.name="MissingProp"}}!function(t){t[t.Minecraft=0]="Minecraft",t[t.MinecraftBedrock=1]="MinecraftBedrock",t[t.SpaceEngineers=2]="SpaceEngineers",t[t.Unknown=-1]="Unknown"}(Game||(Game={}));class Instance{constructor(t,e,r){this.id=t,this.name=e,this.type=r}static fromObject(t){let e=new Instance;return e.id=String(t.id),e.name=String(t.name),e.type=Number(t.type),e}asNetwork(){return new Network(this.id,this.name,Game.Unknown,Platform.Unknown)}delete(){return __awaiter(this,void 0,void 0,(function*(){return yield(new Call).addParam(Param.Instance,this.id).commit("instance/delete").then((()=>{}))}))}}!function(t){t[t.Network=0]="Network",t[t.Server=1]="Server"}(CoreInstanceType||(CoreInstanceType={}));class Network{constructor(t,e,r,n){this.id=t,this.name=e,this.game=r,this.platform=n}asObject(){return JSON.parse(JSON.stringify(this))}static fromObject(t){let e=new Network;return e.name=String(t.name),e.id=String(t.id),e.game=Number(t.game),e.platform=Number(t.platform),e}asInstance(){return new Instance(this.id,this.name,CoreInstanceType.Network)}getMonthRevenue(t=null,e=null){return __awaiter(this,void 0,void 0,(function*(){let r=new Call;return r.addParam(Param.Network,this.id),null!=t&&null!=e&&(r.addParam(Param.Month,t),r.addParam(Param.Year,e)),r.commit("analytics/revenue/month").then((t=>MultipleAnalytics.fromObject(t,AnalyticType.Revenue)))}))}getServers(){return __awaiter(this,void 0,void 0,(function*(){return yield(new Call).addParam(Param.Network,this.id).commit("instance/group/list").then((t=>{let e=new Array;if(Array.isArray(t)){for(let r=0;r<t.length;r++){const n=t[r];e.push(ServerGroupList.fromObject(n))}return e}throw new Error("Invalid result")}))}))}createServer(t){return __awaiter(this,void 0,void 0,(function*(){return yield(new Call).addParam(Param.Network,this.id).addParam(Param.Name,t).commit("instance/create").then((t=>Server.fromObject(t)))}))}createServerGroup(t){return __awaiter(this,void 0,void 0,(function*(){return yield(new Call).addParam(Param.Network,this.id).addParam(Param.Name,t).commit("instance/group/create").then((t=>ServerGroup.fromObject(t)))}))}delete(t){return __awaiter(this,void 0,void 0,(function*(){return t?yield(new Call).addParam(Param.Instance,this.id).commit("instance/delete").then((()=>{})):new Promise(((t,e)=>{e(new Error("missing confirmation"))}))}))}}!function(t){t[t.Unknown=-1]="Unknown",t[t.Mojang=0]="Mojang",t[t.Xbox=1]="Xbox",t[t.Steam=2]="Steam",t[t.Stadia=3]="Stadia",t[t.EpicGames=4]="EpicGames",t[t.Discord=5]="Discord"}(Platform||(Platform={}));class Server{constructor(t,e,r,n){this.network=t,this.id=e,this.name=r,this.group=n}static fromObject(t){let e=new Server;return e.id=String(t.id),e.name=String(t.name),e.group=null,"group"in t&&null!=t.group&&(e.group=ServerGroup.fromObject(t.group)),e}asInstance(){return new Instance(this.id,this.name,CoreInstanceType.Server)}getGroup(){return this.group}setGroup(t){return __awaiter(this,void 0,void 0,(function*(){return yield(new Call).addParam(Param.Server,this.id).addParam(Param.ServerGroup,t.getId()).commit("instance/group/set").then((t=>{let e=Server.fromObject(t);return this.group=e.getGroup(),e}))}))}ungroup(){return __awaiter(this,void 0,void 0,(function*(){return yield(new Call).addParam(Param.Server,this.id).commit("instance/group/unset").then((t=>{let e=Server.fromObject(t);return this.group=e.getGroup(),e}))}))}}class ServerGroupList{constructor(t,e,r,n){this.id=t,this.name=e,this.network=r,this.servers=n}static fromObject(t){let e=new ServerGroupList;if(e.id=null==t.id?null:String(t.id),e.name=null==t.name?null:String(t.name),e.network=null,"network"in t&&null!=t.network&&(e.network=Network.fromObject(t.network)),e.servers=new Array,"servers"in t&&null!=t.servers&&Array.isArray(t.servers))for(let r=0;r<t.servers.length;r++)e.servers.push(Server.fromObject(t.servers[r]));return e}getId(){return this.id}getName(){return this.name}getServers(){return this.servers}asServerGroup(){return new ServerGroup(this.id,this.network,this.name)}}class ServerGroup{constructor(t,e,r){this.id=t,this.network=e,this.name=r}getId(){return this.id}getName(){return this.name}static fromObject(t){let e=new ServerGroup;return e.id=null==t.id?null:String(t.id),e.network=null,"network"in t&&null!=t.network&&(e.network=Network.fromObject(t.network)),e.name=null==t.name?null:String(t.name),e}delete(){return __awaiter(this,void 0,void 0,(function*(){return yield(new Call).addParam(Param.ServerGroup,this.id).commit("instance/group/delete").then((()=>{}))}))}}class Player{constructor(t,e,r,n,i,o,a){this.id=t,this.creation=e,this.username=r,this.lastLogin=n,this.lastUpdated=i,this.bio=o,this.birthdate=a}asObject(){let t=JSON.parse(JSON.stringify(this));return t.lastUpdated=Util.epoch(this.getLastUpdated()),t.lastLogin=Util.epoch(this.getLastLogin()),t.birthdate=Util.epoch(this.getBirthdate()),t.creation=Util.epoch(this.getCreation()),t}getLastUpdated(){return this.lastUpdated}getLastLogin(){return this.lastLogin}getBirthdate(){return this.birthdate}getCreation(){return this.creation}static fromObject(t){let e=new Player;return"id"in t&&(e.id=String(t.id)),"creation"in t&&(e.creation=Util.date(t.creation)),"username"in t&&(e.username=null==t.username?null:String(t.username)),"lastLogin"in t&&(e.lastLogin=Util.date(t.lastLogin)),"lastUpdated"in t&&(e.lastUpdated=Util.date(t.lastUpdated)),"bio"in t&&(e.bio=null==t.bio?null:String(t.bio)),"birthdate"in t&&(e.birthdate=Util.date(t.birthdate)),e}asOwner(){return new Owner(this.id,this.creation,this.username,this.lastLogin,this.lastUpdated,this.bio,this.birthdate)}getBilling(){return new PlayerBilling(this.id,this.creation,this.username,this.lastLogin,this.lastUpdated,this.bio,this.birthdate)}}class Owner extends Player{constructor(t,e,r,n,i,o,a){super(t,e,r,n,i,o,a)}asObject(){let t=JSON.parse(JSON.stringify(this));return t.lastUpdated=Util.epoch(this.getLastUpdated()),t.lastLogin=Util.epoch(this.getLastLogin()),t.birthdate=Util.epoch(this.getBirthdate()),t.creation=Util.epoch(this.getCreation()),t}getNetworks(){return __awaiter(this,void 0,void 0,(function*(){return yield(new Call).commit("network/list/").then((t=>{if(Array.isArray(t)){let e=new Array;for(let r=0;r<t.length;r++)e.push(Network.fromObject(t[r]));return e}throw new Error("Invalid type")}))}))}createNetwork(t,e,r,n){return __awaiter(this,void 0,void 0,(function*(){return r=Util.gameVal(r),n=Util.platformVal(n),yield(new Call).addParam(Param.Name,t).addParam(Param.Cname,e).addParam(Param.Game,r).addParam(Param.Platform,n).commit("network/create/").then((t=>Network.fromObject(t)))}))}}class PlayerBilling extends Player{constructor(t,e,r,n,i,o,a){super(t,e,r,n,i,o,a)}getSubscriptionStatus(){return __awaiter(this,void 0,void 0,(function*(){return yield(new Call).commit("player/billing/subscription/status/").then((t=>{let e=SubscriptionStatus.fromObject(t);return Core.context.setSubscriptionStatus(e),e}))}))}subscribeWithStripe(){return __awaiter(this,void 0,void 0,(function*(){return yield(new Call).commit("player/billing/subscription/plus/start/stripe/").then((t=>{let e=SubscriptionStatus.fromObject(t);return Core.context.setSubscriptionStatus(e),e}))}))}cancelPlus(){return __awaiter(this,void 0,void 0,(function*(){return yield(new Call).commit("player/billing/subscription/plus/cancel/").then((t=>SubscriptionStatus.fromObject(t)))}))}getPaymentMethods(){return __awaiter(this,void 0,void 0,(function*(){return yield(new Call).commit("player/billing/method/list/").then((t=>{let e=new Array;for(let r=0;r<t.length;r++){const n=t[r];e.push(Method.fromObject(n))}return e}))}))}addPaymentMethod(t,e=!1){return __awaiter(this,void 0,void 0,(function*(){let r=null;r="string"==typeof t?t:t.getId();let n="player/billing/method/add/";return e&&(n="player/billing/method/add/default/"),yield(new Call).addParam(Param.PaymentMethod,r).commit(n).then((t=>Method.fromObject(t)))}))}detachPaymentMethod(t){return __awaiter(this,void 0,void 0,(function*(){let e=null;return e="string"==typeof t?t:t.getId(),yield(new Call).addParam(Param.PaymentMethod,e).commit("player/billing/method/detach/").then((()=>{}))}))}getBillingAddress(){return __awaiter(this,void 0,void 0,(function*(){return yield(new Call).commit("player/billing/address/get/").then((t=>Address.fromObject(t)))}))}setBillingAddress(t){return __awaiter(this,void 0,void 0,(function*(){return t instanceof Address||(t=Address.fromObject(t)),yield(new Call).addParam(Param.Address,t.asQuery()).commit("player/billing/address/set/").then((t=>Address.fromObject(t)))}))}}class Context{getNetwork(){return this.network}getSubscriptionStatus(){return this.subscriptionStatus}updateSubscriptionStatus(){let t=this;Core.getCopy().getPlayer().getBilling().getSubscriptionStatus().then((e=>{t.subscriptionStatus=e}))}setSubscriptionStatus(t){this.subscriptionStatus=t}setNetwork(t){if("string"==typeof t){let e=this;e.network=new Network(String(t),null,null,null),Core.getCopy().getNetwork(t).then((t=>{e.network=t}))}else this.network=t}}class Util{static dec2hex(t){return t.toString(16).padStart(2,"0")}static generateGibberish(t){var e=new Uint8Array((t||40)/2);return window.crypto.getRandomValues(e),Array.from(e,Util.dec2hex).join("")}static shortLengthToLong(t){let e="",r=Math.floor(16*Math.random());r%2<=0&&(r+=1);let n=16+r;e=Number(t*r).toString(2);let i="";for(let t=0;t<n;t++)i+=t==n-1?String(t)+e:String(t)+e+"!@#";return btoa(i)}static longLengthToShort(t){let e=atob(t).split("!@#"),r=parseInt(e[0].substring(1,e[0].length-1),2)/(e.length-16);return Math.floor(2*r)}static epoch(t){return null==t?null:t.getTime()/1e3}static date(t){if(null!=t&&0!=t){let e=new Date(0);return e.setUTCSeconds(t),e}return null}static gameVal(t){if("string"==typeof t)if(isNaN(Number(t)))switch(t=String(t).toLowerCase(),!0){case["mc","minecraft"].includes(t):t=Game.Minecraft;break;case["mc bedrock","bedrock","minecraft bedrock","minecraft_bedrock","minecraftbedrock"].includes(t):t=Game.MinecraftBedrock,console.log(t);break;case["se","spaceengineers","space engineers"].includes(t):t=Game.SpaceEngineers;break;default:t=Game.Unknown}else t=Number(t);return Game.SpaceEngineers,t<Game.Unknown&&(t=Game.Unknown),t}static platformVal(t){if("string"==typeof t)if(isNaN(Number(t)))switch(t=String(t).toLowerCase(),!0){case["mojang"].includes(t):t=Platform.Mojang;break;case["xbox","microsoft"].includes(t):t=Platform.Xbox;break;case["google","stadia"].includes(t):t=Platform.Stadia;break;case["steam","valve"].includes(t):t=Platform.Steam;break;case["discord","discord-o!"].includes(t):t=Platform.Discord;break;case["epic","epicgames"].includes(t):t=Platform.EpicGames;break;default:t=Platform.Unknown}else t=Number(t);return Platform.Discord,t<Platform.Unknown&&(t=Platform.Unknown),t}}